<div class="node" [class.waitingForJoin]="waitingForJoin">
  <div class="waitingForJoin" *ngIf="waitingForJoin" (click)="join()"></div>
  <header>
    <span id="{{ elementRef.nativeElement.id + '_join' }}"></span>
    <ng-content select="dragHandle"> </ng-content>
    <div class="options">
      <span class="options__remove" (click)="onRemoveNode()"></span>
    </div>
  </header>
  <main>
    @if(type==='distributor'){
    <div *ngIf="conditions && conditions.length > 0" class="node__answers">
      <polo-condition
        *ngFor="let condition of conditions"
        id="{{ condition.id }}"
        [nodeId]="elementRef.nativeElement.id"
        [selectedRef]="condition.ref"
        [comparator]="condition.comparator"
        [value]="condition.value"
        (onRemoveCondition)="removeCondition($event)"
        (onWillJoin)="willJoin($event)"
      ></polo-condition>
    </div>
    <button (click)="addCondition()">Add condition</button>
    } @else if(type==='end'){
    <textarea (change)="saveNodeText($event)">{{ text }}</textarea>
    }@else {
    <textarea (change)="saveNodeText($event)">{{ text }}</textarea>
    <div *ngIf="answers && answers.length > 0" class="node__answers">
      <polo-answer
        *ngFor="let answer of answers"
        id="{{ answer.id }}"
        [nodeId]="elementRef.nativeElement.id"
        [text]="answer.text"
        (onRemoveAnswer)="removeAnswer($event)"
        (onWillJoin)="willJoin($event)"
      ></polo-answer>
    </div>
    <button (click)="addAnswer()">Add answer</button>
    }
  </main>
</div>
